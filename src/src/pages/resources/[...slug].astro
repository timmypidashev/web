---
import { getCollection } from "astro:content";
import ContentLayout from "@/layouts/content.astro";
import PresentationLayout from "@/layouts/presentation.astro";
import Presentation from "@/components/presentation/Presentation.astro";

const { slug } = Astro.params;

const resources = await getCollection("resources");
const resource = resources.find(item => item.slug === slug);

if (!resource) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  });
}

const { Content } = await resource.render();

const formattedDate = new Date(resource.data.date).toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric"
});

// Check if this is a curriculum resource to auto-start presentation
const isCurriculum = resource.slug.includes('curriculum');
const LayoutComponent = isCurriculum ? PresentationLayout : ContentLayout;
---

<LayoutComponent
  title={`${resource.data.title} | Timothy Pidashev`}
  description={resource.data.description}
>
  <Presentation autoStart={isCurriculum} title="Start Presentation" />
  
  <div class="relative max-w-8xl mx-auto">
    <Content />
  </div>
</LayoutComponent>
